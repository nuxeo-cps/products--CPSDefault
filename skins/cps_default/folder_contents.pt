<tal:x define="dummy here/filterCookie;"/>
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/content_lib/macros/master"
>
<body>
<div metal:fill-slot="main"
     tal:define="m_tool here/portal_membership;
                 checkPerm nocall: m_tool/checkPermission;
                 list_here python:checkPerm('List folder contents', here);
                 list_parent python:checkPerm( 'List folder contents', here
                                             , 'aq_parent' );
                "
     i18n:domain="cmf_default"
>
<div tal:condition="not: list_here"
      tal:define="response request/RESPONSE;
                  url here/absolute_url;
                 "
 >
  <span tal:define="redirect python: response.redirect( url )"></span>
</div>

<!-- This is the desktop area -->
<div class="Desktop">

<form action="" method="post"
      tal:attributes="action here/absolute_url">
 <table class="FormLayout">
  <tr>
   <td valign="top">
    <table class="ContentsList">
     <tbody tal:condition="list_parent">
      <tr valign="top"
          tal:define="upNav python: hasattr(here.aq_parent, 'portal_url');
                      upID python: here.aq_parent.getId()">
        <td colspan="3" align="left">
         <span tal:condition="upNav | nothing">
          <a href="../folder_contents"
          ><img src="" alt="[Link]" border="0"
                tal:attributes="src string:${here/portal_url}/UpFolder_icon.gif"
          /></a>
         </span>&nbsp;&nbsp;
         <span tal:condition="upNav">
          <span tal:omit-tag="" i18n:translate="">Up to</span>
          <a href="../folder_contents"
                   tal:content="upID">Up ID</a>
         </span>
         <span tal:condition="python: not(upNav)">
           <span class="mild" i18n:translate="">Root</span>
         </span>
        </td>
      </tr>
     </tbody>

    </table>

    <tal:block define="
                  no_form python:not checkPerm('Delete objects', here);
                  items python:here.getFolderContents(sort_by='status');
                  format string:compact;
                  columns python:2;
                  items_per_page python:15">
      <metal:block use-macro="here/content_lib/macros/display_contents" />
    </tal:block>
    
    <table border="0" cellspacing="0" cellpadding="2">
     <tr>
      <td align="left" valign="top" width="16"></td>
      <td align="left" valign="top">
      <span tal:condition="python: test(checkPerm('Add portal content', here)
            and here.allowedContentTypes(), 1, 0)">
        <input type="submit" name="folder_factories:method" value="New..."
               i18n:attributes="value" />
      </span>
      <span tal:condition="python: checkPerm('Delete objects', here)">
        <input type="submit" name="folder_rename_form:method" value="Rename"
               i18n:attributes="value" />
        <input type="submit" name="folder_delete:method" value="Delete"
               i18n:attributes="value" />
      </span>
      </td>
     </tr>
    </table>

   </td>
  </tr>
 </table>
</form>

<div tal:replace="structure here/folder_filter_form">Filter Form Here</div>

</div>
</div>
</body>
</html>
