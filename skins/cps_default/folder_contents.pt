<metal:block use-macro="here/content_lib/macros/master">
<div metal:fill-slot="main"
     tal:define="list_here python:checkPerm('List folder contents', here);
                 list_parent python:checkPerm('List folder contents', here, 'aq_parent');">
<div tal:condition="not: list_here"
  tal:define="response request/RESPONSE;url here/absolute_url;">
  <span tal:define="redirect python: response.redirect(url)"></span>
</div>

<div class="Desktop">
  <tal:block condition="list_parent"
    define="upNav python: hasattr(here.aq_parent, 'portal_url');
            upID python: here.aq_parent.getId()">
    <span tal:condition="upNav | nothing">
      <a href="../folder_contents"><img src="" alt="[Link]" border="0"
        tal:attributes="src string:${base_url}UpFolder_icon.gif"></a>
    </span>&nbsp;&nbsp;
    <span tal:condition="upNav" i18n:translate="">description_up_to
      <a href="../folder_contents"
         tal:content="upID" i18n:name="up_id">Up ID</a>
    </span>
  </tal:block>

  <form action="" method="post"
      tal:attributes="action here/absolute_url">

   <tal:block define="no_form python:not checkPerm('Delete objects', here);
                     items python:here.getFolderContents(sort_by='status');
                     format string:compact;
                     columns python:2;
                     items_per_page python:15">
     <metal:block use-macro="here/content_lib/macros/display_contents" />
   </tal:block>

   <table border="0" cellspacing="0" cellpadding="2">
     <tr>
      <td align="left" valign="top" width="16"></td>
      <td align="left" valign="top">
      <span tal:condition="python: test(checkPerm('Add portal content', here)
            and here.allowedContentTypes(), 1, 0)">
        <input type="submit" name="folder_factories:method" value="button_new"
               i18n:attributes="value">
      </span>
      <span tal:condition="python: checkPerm('Delete objects', here)">
        <input type="submit" name="folder_rename_form:method" value="button_rename"
               i18n:attributes="value">
        <input type="submit" name="folder_delete:method" value="button_delete"
               i18n:attributes="value">
      </span>
      </td>
     </tr>
   </table>
   <table width="100%" border="0" cellspacing="0" cellpadding="0">
     <tr>
       <td width="100%" align="right">
         <tal:block define="display_change python:request.get('change_display', '0')">
           <a href="./folder_contents?change_display=1" i18n:translate="link_change_display"
              tal:condition="python:display_change == '0'">
              Change display settings
           </a> 
           <a href="./folder_contents" i18n:translate="link_hide_display_settings"
              tal:condition="python:display_change == '1'">
              Hide display settings
           </a>           
         </tal:block> 
       </td>
     </tr>
   </table>
  </form>
</div>

</div>
</metal:block>
