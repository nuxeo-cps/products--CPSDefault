<tal:x define="dummy here/filterCookie;"/>
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
>
<body>
<div metal:fill-slot="main"
     tal:define="m_tool here/portal_membership;
                 checkPerm nocall: m_tool/checkPermission;
                 list_here python:checkPerm('List folder contents', here);
                 list_parent python:checkPerm( 'List folder contents', here
                                             , 'aq_parent' );
                "
     i18n:domain="cmf_default"
>
<div tal:condition="not: list_here"
      tal:define="response request/RESPONSE;
                  url here/absolute_url;
                 "
 >
  <span tal:define="redirect python: response.redirect( url )"></span>
</div>

<!-- This is the desktop area -->
<div class="Desktop">

<form action="" method="post"
      tal:attributes="action here/absolute_url">
 <table class="FormLayout">
  <tr>
   <td valign="top">
    <table class="ContentsList">
     <!-- Navigate to parent -->
     <tbody tal:condition="list_parent">
      <tr valign="top"
          tal:define="upNav python: hasattr(here.aq_parent, 'portal_url');
                      upID python: here.aq_parent.getId()">
        <td colspan="3" align="left">
         <span tal:condition="upNav | nothing">
          <a href="../folder_contents"
          ><img src="" alt="[Link]" border="0"
                tal:attributes="src string:${here/portal_url}/UpFolder_icon.gif"
          /></a>
         </span>&nbsp;&nbsp;
         <span tal:condition="upNav">
          <span tal:omit-tag="" i18n:translate="">Up to</span>
          <a href="../folder_contents"
                   tal:content="upID">Up ID</a>
         </span>
         <span tal:condition="python: not(upNav)">
           <span class="mild" i18n:translate="">Root</span>
         </span>
        </td>
      </tr>
     </tbody>
     <!-- This row holds the "two column list" -->
     <tr tal:define="global b_start string:0;
                     b_start request/b_start | b_start;
                     filterString python: request.get('folderfilter', '');
                     filter python: here.decodeFolderFilter(filterString);
                     items python: here.folder_contents_get(
                                                contentFilter=filter);
                     Batch nocall: modules/ZTUtils/Batch;
                     global batch1 python:Batch( items, 10, int(b_start)
                                              , orphan=0);
                    "
     >
      <!-- First column, first half batch in 'batch1'. -->
      <td colspan="2" align="left">
       <table>
        <tr valign="top" tal:repeat="item batch1">
         <td align="left" width="5">
            <input type="checkbox" name="ids:list" value="" id=""
                   tal:attributes="value item/getId;
                                   id python: 'cb_' + item.getId()" />
         </td>
         <td>
	   <span tal:condition="not:item/isPrincipiaFolderish"
	     tal:define="info python:here.getContentInfo(item, level=1);">
	     <metal:block use-macro="here/content_lib/macros/info_detail" />
	   </span>

	   <span tal:condition="item/isPrincipiaFolderish">
	     <a href="." tal:attributes="href string:${item/getId}/folder_contents;">
	       <strong><span tal:replace="item/title_or_id">ID</span></strong></a>
	   </span>
         </td>
        </tr>
       </table>
      </td>
     </tr>

     <tr>
      <td align="left">
       <span tal:define="p batch1/previous" tal:condition="p">
        <a href=""
           tal:attributes="
                href string:folder_contents?b_start=${p/first}"
           i18n:translate=""
        >Previous Items</a>
       </span>
      </td>
      <td>&nbsp;</td>
      <td align="right">
       <span tal:define="n batch1/next | nothing" tal:condition="n">
        <a href=""
           tal:attributes="
                href string:folder_contents?b_start=${batch1/end}"
           i18n:translate=""
        >Next Items</a>
       </span>
      </td>
     </tr>
    <!-- end contentList -->
    </table>

    <table border="0" cellspacing="0" cellpadding="2">
     <tr>
      <td align="left" valign="top" width="16"></td>
      <td align="left" valign="top">
      <span tal:condition="python: test(checkPerm('Add portal content', here)
            and here.allowedContentTypes(), 1, 0)">
        <input type="submit" name="folder_factories:method" value="New..."
               i18n:attributes="value" />
      </span>
      <span tal:condition="python: checkPerm('View management screens', here)">
        <input type="submit" name="folder_rename_form:method" value="Rename"
               i18n:attributes="value" />
      </span>
      <span tal:condition="python: checkPerm('Delete objects', here)">
        <input type="submit" name="folder_delete:method" value="Delete"
               i18n:attributes="value" />
      </span>
      </td>
     </tr>
    </table>

   </td>
  </tr>
 </table>
</form>

<div tal:replace="structure here/folder_filter_form">Filter Form Here</div>

</div>
</div>
</body>
</html>
