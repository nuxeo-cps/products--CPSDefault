<metal:html use-macro="here/main_template/macros/master">

<metal:main fill-slot="main"
  tal:define="context_urlc python:here.getContextUrl(utool=utool, concat=1);">



<div class="documentActions">
  <a href="box_create_form" i18n:translate="button_create_box"
    tal:attributes="href string:${context_urlc}/box_create_form">Add a box</a>
</div>
<h2 i18n:translate="heading_box_manage_form">Boxes management</h2>

<p i18n:translate="">
description_visible_box_from <span i18n:name="context_url"
tal:content="context_url" /></p>

<tal:block repeat="slot here/getBoxSlots">
<tal:block define="sboxes python:btool.getBoxes(here,
                          include_only_in_subfolder=1);
                   sboxes python:btool.filterBoxes(sboxes, slot=slot,
                          keep_closed=1);"
           condition="python:len(sboxes)">
<h3>
<tal:block replace="structure
 python:here.getImgTag('slot_' + slot + '.png', base_url=base_url)" />
    <span i18n:translate="label_slot" />: <span i18n:translate="" tal:content="string:label_${slot}">Slot</span></h3>


<table width="100%">
  <tr>
    <th i18n:translate="listingheader_order" width="5%">Order</th>
    <th i18n:translate="listingheader_type" width="25%">Type</th>
    <th i18n:translate="listingheader_title" width="25%">Title</th>
    <th i18n:translate="listingheader_location" width="30%">location</th>
    <th i18n:translate="listingheader_action" width="15%">action</th>
  </tr>
  <tal:block repeat="box sboxes">
  <tr tal:define="action python:box['box'].getTypeInfo().immediate_view;
                  editable python:checkPerm('Manage Boxes', box['box'])"
    tal:attributes="class python:test(repeat['box'].even(), 'even', 'odd')">
    <td align="right"><tal:block replace="box/box/order" /></td>
    <td nowrap>
      <tal:block
        i18n:translate="" content="python:box['box'].getTypeInfo().Title()" />
    </td>
    <td><tal:block replace="box/box/title" /></td>
    <td nowrap><tal:block replace="string:${base_url}${box/display_url}" /></td>
    <td nowrap>
      <tal:block condition="editable">
        <a href="" tal:attributes="href
      string:${context_urlc}/${action}?box_url=${box/url}"
      i18n:translate="link_box_edit">edit</a>,

      <a href="" i18n:translate="link_box_delete"
      tal:attributes="href string:${context_urlc}/box_delete?box_url=${box/url};
      onclick python:'return window.confirm(\'%s\')' % (cpsmcat('description_confirm_delete'), )">delete</a>
      </tal:block>
      <tal:block condition="not:editable">
        <a href="" tal:attributes="href
      string:${context_urlc}/${action}?box_url=${box/url}" i18n:translate="link_box_view">view</a>
      </tal:block>
    </td>
  </tr>
  </tal:block>
</table>
<br>
<br>

</tal:block>
</tal:block>

</metal:main>
</metal:html>
