<metal:html tal:define="display_change request/change_display|nothing;
                         params here/getDisplayParams;
                         sort_by params/sort_by;
                         direction params/direction;
                         format params/format;
                         ">

<metal:body use-macro="here/content_lib/macros/master">

<metal:header metal:fill-slot="header">

<h1 tal:content="here/title_or_id">Page Title</h1>

<div align="right">
  <form action="" method="post" name="formf"
        tal:attributes="action here/absolute_url">
    <metal:params use-macro="here/content_lib/macros/display_params_form" />
    <input type="submit" value="button_change" class="standalone"
           i18n:attributes="value" name="changeDisplayParams:method">
  </form>
</div>
</metal:header>

<metal:main fill-slot="main"
     tal:define="list_here python:checkPerm('List folder contents', here);
                 list_parent python:checkPerm('List folder contents', here, 'aq_parent')">

<div tal:condition="not: list_here"
  tal:define="response request/RESPONSE;url here/absolute_url;">
  <span tal:define="redirect python: response.redirect(url)"></span>
</div>

  <tal:block condition="list_parent">
     <a href="../xx"
        tal:attributes="href python:test(hasattr(here.aq_parent.aq_parent,
           'portal_url'), '../folder_contents', '..')">
     <tal:block replace="structure
       python:here.getImgTag('UpFolder_icon.gif', base_url=base_url)" />
       <span i18n:translate="">description_up_to
         <b i18n:name="up_id" tal:content="python:here.aq_parent.getId()">
         Up ID</b>
       </span></a><br><br>
  </tal:block>

  <form action="" method="post"
        tal:attributes="action here/absolute_url">

   <tal:block define="no_form python:not checkPerm('Delete objects', here);
                      nav_action string:folder_contents;
                      items python:here.getFolderContents();">
     <metal:block use-macro="here/content_lib/macros/display_contents" />
   </tal:block>

   <table border="0" width="100%" cellspacing="0" cellpadding="2">
     <tr>
      <td align="left" valign="top" width="16"></td>
      <td align="left" valign="top"
          tal:define="can_add python:test(checkPerm('Add portal content',
                              here), 1, 0)">
      <span tal:condition="python:can_add and here.allowedContentTypes()">
        <input type="submit" name="folder_factories:method" value="button_new"
               class="standalone" i18n:attributes="value">
      </span>
      <span tal:condition="can_add">
        <input type="submit" name="folder_cut:method" value="button_cut"
          class="context" i18n:attributes="value">
        <input type="submit" name="folder_copy:method" value="button_copy"
          class="context" i18n:attributes="value">
      </span>
      <span tal:condition="python:can_add and here.cb_dataValid()">
        <input type="submit" name="folder_paste:method" value="button_paste"
          class="context" i18n:attributes="value">
      </span>
      <span tal:condition="python: checkPerm('Delete objects', here)">
        <input type="submit" name="folder_rename_form:method"
          class="context" value="button_rename" i18n:attributes="value">
        <input type="submit" name="folder_delete:method" value="button_delete"
          class="destructive" i18n:attributes="value"
          tal:attributes="onclick python:'return window.confirm(\'%s\')' %
          (cpsmcat('description_confirm_delete'), )">
        <tal:block tal:define="isWsManager python:mtool.checkPermission('View management screens', here);"
                   condition="python:isWsManager and sort_by is None">

          <br>
          <input type="submit" value="button_move_up" class="context moveUp"
                 i18n:attributes="value" name="moveItemsUp:method">
          <input type="submit" value="button_move_down" class="context moveDown"
                 i18n:attributes="value" name="moveItemsDown:method">
          <input type="submit" value="button_move_top" class="context moveTop"
                 i18n:attributes="value" name="moveItemsTop:method">
          <input type="submit" value="button_move_bottom"
                 class="context moveBottom"
                 i18n:attributes="value" name="moveItemsBottom:method">
        </tal:block>
      </span>
      </td>
     </tr>
   </table>
  </form>
</metal:main>
</metal:body>
</metal:html>
