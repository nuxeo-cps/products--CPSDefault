<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- cat cps_devel/main_template.pt | grep -v CPSD_  > cps_default/main_template.pt -->
<html metal:define-macro="master"
      tal:define="
                  showthirdcol showthirdcol|python:1;
                  utool nocall:here/portal_url;
                  atool here/portal_actions;
                  mtool here/portal_membership;
                  ttool here/portal_trees;
                  wtool here/portal_workflow;
                  btool here/portal_boxes;
                  context_url python:here.getContextUrl(utool=utool);
                  base_url python:here.getBaseUrl(utool=utool);
                  boxes python:btool.getBoxes(here);
                  member mtool/getAuthenticatedMember;
                  isAnon mtool/isAnonymousUser;
                  actions python:atool.listFilteredActionsFor(here);
                  wf_state python:wtool.getInfoFor(here,'review_state','');
                  CPSD_BMT python:here.Benchmarktimer('main_template');
                  CPSD_bmt_start nocall:CPSD_BMT/start;
                  CPSD_bmt_stop nocall:CPSD_BMT/stop;
                  CPSD_bmt_mark nocall:CPSD_BMT/setMarker;
                  CPSD_bmt_elapsed nocall:CPSD_BMT/getProfiling;
                  ">
<span tal:replace="CPSD_bmt_start" />
<head metal:use-macro="here/generic_lib/macros/header">
  <metal:block fill-slot="base">
    <metal:block define-slot="base">
      <base href="" tal:attributes="href string:${here/absolute_url}/">
    </metal:block>
  </metal:block>

  <metal:block fill-slot="head_slot">
    <metal:block define-slot="head_slot" />
  </metal:block>

  <metal:block fill-slot="css_slot">
    <metal:block define-slot="css_slot" />
  </metal:block>
  
  <metal:block fill-slot="javascript_head_slot">
    <metal:block define-slot="javascript_head_slot" />
  </metal:block>

</head>

<body>
<!-- HEADER =================================== -->
<div>

  <!-- top bar -->
  <div class="top">
    <div metal:use-macro="here/generic_lib/macros/searchbox" />
    <div metal:use-macro="here/generic_lib/macros/logo" />
  </div>

  <hr size="" class="netscape4" />

  <!-- section bar -->
  <div metal:use-macro="here/generic_lib/macros/sections">
    sections
  </div>

  <hr size="" class="netscape4" />

  <!-- breadcrumbs -->
  <div metal:use-macro="here/generic_lib/macros/breadcrumbs">
    breadcrumbs
  </div>

  <hr size="" class="netscape4" />

</div>

<table width="100%" border="0" cellspacing="0" cellpadding="0"
       align="center" valign="top" class="columns">
  <tr>
    <!-- BAR LEFT ================================= -->
    <td class="left" width="150" tal:define="blockclass string:even">

      <tal:block replace="structure here/Localizer/changeLanguageForm" />
      <!-- display left boxes -->
      <b tal:replace="python:CPSD_bmt_mark('LEFT_boxes_start')" />
      <tal:block repeat="box python:btool.filterBoxes(boxes, slot='left');">
        <metal:block use-macro="python:path(box['macro'])" />
      </tal:block>
      <b tal:replace="python:CPSD_bmt_mark('LEFT_boxes_stop')" />     

    </td>

    <!-- MAIN = no width to let it float ========== -->    
    <td class="main">

      <!-- display top boxes -->
      <b tal:replace="python:CPSD_bmt_mark('TOP_boxes_start')" />
        <tal:block repeat="box python:btool.filterBoxes(boxes, slot='top');">
          <metal:block use-macro="python:path(box['macro'])" />
        </tal:block>
      <b tal:replace="python:CPSD_bmt_mark('TOP_boxes_stop')" />     

      <div class="document">
      
        <div id="content">
          <b tal:replace="python:CPSD_bmt_mark('main_start')" />

          <!-- portal status message -->
          <metal:block use-macro="here/generic_lib/macros/portal_message" />

          <!-- header -->
          <metal:block define-slot="header" />

          <!-- main -->
          <metal:block define-slot="main" />

          <!-- bottom -->
          <metal:block define-slot="sub" />

          <b tal:replace="python:CPSD_bmt_mark('main_stop')" />
        </div>

      </div>
    </td>
    
    <!-- BAR RIGHT ================================ -->
    <td class="right" width="150" tal:condition="showthirdcol"
        tal:define="blockclass string:odd">
      <!-- display right boxes -->
      <b tal:replace="python:CPSD_bmt_mark('RIGHT_boxes_start')" />
      <tal:block repeat="box python:btool.filterBoxes(boxes, slot='right');">
        <metal:block use-macro="python:path(box['macro'])" />
      </tal:block>
      <b tal:replace="python:CPSD_bmt_mark('RIGHT_boxes_stop')" />     
      
    </td>
    <td width="1" tal:condition="not:showthirdcol">
    </td>
  </tr>


  <!-- ICONS FOR CLOSED BOXES ======================= -->
  <tr tal:define="closed_box python:btool.filterBoxes(boxes, '', closed_only=1)" tal:condition="closed_box"><td colspan="3" class="left">
    <span i18n:translate="closed_boxes">Closed boxes :&nbsp;</span>
    <tal:block repeat="box closed_box">
      <metal:block use-macro="here/box_lib/macros/closed_box" />
    </tal:block>
  </td></tr>

</table>

<!-- FOOTER =================================== -->
<hr size="" class="netscape4" />

<div metal:use-macro="here/generic_lib/macros/footer">
  the footer
</div>

 <span tal:replace="CPSD_bmt_stop" /><span tal:replace="structure CPSD_bmt_elapsed" /><span tal:replace="structure request/other/bench_mark_profiler|nothing" />

</body>
</html>
