<html metal:use-macro="here/content_lib_master/macros/master">
  <body>

    <div tal:condition="python: not(checkPerm('Access contents information', here))">
      <span tal:define="dummy here/unauthRedirect"></span>
    </div>

    <h1 metal:fill-slot="header" i18n:translate="heading_folder_factories">
      Add Content
    </h1>

    <div class="group"
          metal:fill-slot="main"
          tal:define="creatableItems python:here.getSortedContentTypes(custom_order=True);
            showFirst python:5">

      <div tal:condition="python: len(creatableItems) == 1">
        <span id="dummy_for_redirect"
              tal:define="response request/RESPONSE;
                          item python:creatableItems[0];
                          rurl string:${here_url}/content_create?type_name=${item/getId};
                          redirect python:response.redirect(rurl)"/>
      </div>
      <tal:block tal:condition="python:creatableItems and len(creatableItems)>1">
        <tal:block tal:define="creatableItems1 python:creatableItems[:showFirst];
          creatableItems2 python:creatableItems[showFirst:]">
          <dl>
          <tal:block repeat="item creatableItems1">
            <tal:block define="choice_id string:choice_${repeat/item/number}">
              <dt>
                <img tal:replace="structure python:here.getImgTag(item.getIcon(),
                  base_url=base_url)" />
                <a tal:attributes="
                  href string:${here_url}/content_create?type_name=${item/getId}"
                  tal:content="item/Title"
                  i18n:translate="">
                  Portal type's title
                </a>
              </dt>
              <dd tal:content="item/Description" i18n:translate="">
                Portal type's description
              </dd>
            </tal:block>
          </tal:block>
          </dl>
          <tal:block condition="creatableItems2">
            <div id="more_block" class="more_block"
              style="display:block">
              <a tal:attributes="
                 href string:javascript:toggleLayers('more_block', 'more_items')"
                 i18n:translate="more_choices_folder_factories">
                 more choices
              </a>
            </div>
            <div style="display:none" id="more_items">
              <dl>
              <tal:block repeat="item creatableItems2"
                define="value python:'ceva'">
                <tal:block define="choice_id string:choice_${repeat/item/number}">
                  <dt>
                    <img tal:replace="structure python:here.getImgTag(item.getIcon(),
                        base_url=base_url)" />
                    <a tal:attributes="
                      href string:${here_url}/content_create?type_name=${item/getId}"
                      tal:content="item/Title"
                      i18n:translate="">
                      Portal type's title
                    </a>
                  </dt>
                  <dd tal:content="item/Description" i18n:translate="">
                    Portal type's description
                  </dd>
                </tal:block>
              </tal:block>
              </dl>
            </div>
          </tal:block>
        </tal:block>
      </tal:block>

      <p tal:condition="not:creatableItems">
        <span i18n:translate="help_no_content_type_can_be_created">
          No content type can be created.
        </span>
      </p>

    </div>

  </body>
</html>
